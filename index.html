<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Charger Locator — Demo</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#06b6d4;--muted:#94a3b8}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Arial;background:linear-gradient(180deg,#071029 0%, #07172a 100%);color:#e6eef6;margin:0;padding:20px}
    .container{max-width:980px;margin:0 auto}
    header{display:flex;gap:16px;align-items:center}
    .logo{width:72px;height:72px;border-radius:12px;background:linear-gradient(135deg,#0ea5a4,#2563eb);display:flex;align-items:center;justify-content:center;font-weight:700}
    h1{font-size:20px;margin:0}
    p.lead{color:var(--muted);margin:6px 0 18px}
    .card{background:rgba(255,255,255,0.03);padding:16px;border-radius:12px;margin-bottom:14px}
    .details{display:flex;gap:12px;flex-wrap:wrap}
    .chip{background:rgba(255,255,255,0.03);padding:8px 10px;border-radius:8px;color:var(--muted);font-size:13px}
    #mapPlaceholder{height:220px;border-radius:10px;background:linear-gradient(90deg,#032330,#072d3b);display:flex;align-items:center;justify-content:center;color:rgba(255,255,255,0.25);margin-top:10px}
    .controls{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
    button{background:var(--accent);border:none;padding:10px 12px;border-radius:10px;color:#042028;cursor:pointer;font-weight:600}
    button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .list{margin-top:14px}
    .seller{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;margin-bottom:8px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
    .seller .left{display:flex;gap:12px;align-items:center}
    .avatar{width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,#1e40af,#06b6d4);display:flex;align-items:center;justify-content:center;font-weight:700}
    .meta{line-height:1}
    .meta small{display:block;color:var(--muted)}
    .rating{display:flex;gap:8px;align-items:center}
    .badge{min-width:44px;text-align:center;padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.04);font-weight:700}
    .bar{height:10px;border-radius:999px;background:rgba(255,255,255,0.06);overflow:hidden;width:160px}
    .bar > i{display:block;height:100%;background:linear-gradient(90deg,#34d399,#06b6d4);width:0%}
    .note{color:var(--muted);font-size:13px;margin-top:10px}
    footer{margin-top:18px;color:var(--muted);font-size:13px}
    @media(max-width:640px){.details{flex-direction:column}.controls{flex-direction:column} }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">CP</div>
      <div>
        <h1>Charger Locator — Demo</h1>
        <p class="lead">Detect nearby sellers for the charger and show a closeness rating (1–10). This is a demo: it uses your browser's location and a small set of sample sellers.</p>
      </div>
    </header><div class="card">
  <strong>Charger details (from your picture)</strong>
  <div class="details" style="margin-top:8px">
    <div class="chip">Brand: Penergy</div>
    <div class="chip">Power: 65W</div>
    <div class="chip">Output: 19.5V ⎓ 3.33A</div>
    <div class="chip">Tip: 4.5 × 3.0 mm (blue pin)</div>
    <div class="chip">Fits: HP Probook / Pavilion (common models)</div>
  </div>
  <div id="mapPlaceholder">Map placeholder — demo only (no external map loaded)</div>

  <div class="controls">
    <button id="findBtn">Find nearby chargers (use location)</button>
    <button class="secondary" id="simulateBtn">Simulate Cape Town test</button>
    <button class="secondary" id="resetBtn">Reset</button>
  </div>
  <div class="note">Tip: allow location permissions when prompted. This demo does not query real stores — it compares your position to sample seller coordinates and converts distance to a 1–10 closeness rating.</div>
</div>

<div class="list card" id="results">
  <strong>Nearby results</strong>
  <div id="sellersList" style="margin-top:12px"></div>
</div>

<footer>Created as a demo — you can edit the seller list in the source. Rating 10 = very close; rating 1 = far.</footer>

  </div>  <script>
    // Sample seller data (latitude, longitude). You can replace these with real store coords.
    const sampleSellers = [
      {name:'Cape Town Electronics', lat:-33.9249, lon:18.4241},
      {name:'Woodstock Tech Store', lat:-33.9260, lon:18.4350},
      {name:'Muizenberg Charger Hub', lat:-34.1053, lon:18.4717},
      {name:'Bellville Spares', lat:-33.8958, lon:18.6220},
      {name:'Strand Tech', lat:-34.1018, lon:18.8292}
    ];

    const maxDistanceKm = 60; // distance that maps roughly to rating 1

    function toRad(deg){return deg*Math.PI/180}
    function haversine(lat1, lon1, lat2, lon2){
      const R = 6371; // km
      const dLat = toRad(lat2-lat1);
      const dLon = toRad(lon2-lon1);
      const a = Math.sin(dLat/2)*Math.sin(dLat/2) + Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*Math.sin(dLon/2)*Math.sin(dLon/2);
      const c = 2*Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R*c;
    }

    function distanceToRating(dKm){
      // rating 10 for 0 km, rating 1 for >= maxDistanceKm
      const clamped = Math.max(0, Math.min(dKm, maxDistanceKm));
      const normalized = 1 - (clamped / maxDistanceKm); // 1 -> 0
      const rating = Math.round(1 + normalized * 9); // 1..10
      return rating;
    }

    function renderSellers(userLat, userLon){
      const container = document.getElementById('sellersList');
      container.innerHTML = '';
      const computed = sampleSellers.map(s => {
        const d = haversine(userLat, userLon, s.lat, s.lon);
        return {...s, distance: d, rating: distanceToRating(d)};
      }).sort((a,b)=>a.distance-b.distance);

      computed.forEach(s => {
        const el = document.createElement('div');
        el.className = 'seller';
        el.innerHTML = `
          <div class="left">
            <div class="avatar">${s.name.split(' ').map(w=>w[0]).slice(0,2).join('')}</div>
            <div class="meta">
              <strong>${s.name}</strong>
              <small>${s.distance.toFixed(2)} km away — ${s.lat.toFixed(4)}, ${s.lon.toFixed(4)}</small>
            </div>
          </div>
          <div class="rating">
            <div class="badge">${s.rating}</div>
            <div class="bar" aria-hidden>
              <i style="width:${(s.rating/10*100).toFixed(1)}%"></i>
            </div>
          </div>
        `;
        container.appendChild(el);
      });
    }

    document.getElementById('findBtn').addEventListener('click', ()=>{
      if(!navigator.geolocation){
        alert('Geolocation not supported in this browser.');
        return;
      }
      navigator.geolocation.getCurrentPosition(pos=>{
        const lat = pos.coords.latitude;
        const lon = pos.coords.longitude;
        renderSellers(lat, lon);
        document.getElementById('mapPlaceholder').textContent = `Your location: ${lat.toFixed(4)}, ${lon.toFixed(4)}`;
      }, err=>{
        alert('Could not get location: ' + err.message);
      }, {enableHighAccuracy:true, timeout:10000});
    });

    document.getElementById('simulateBtn').addEventListener('click', ()=>{
      // simulate a point in Cape Town center
      const lat = -33.9249; const lon = 18.4241;
      renderSellers(lat, lon);
      document.getElementById('mapPlaceholder').textContent = `Simulated location: ${lat.toFixed(4)}, ${lon.toFixed(4)} (Cape Town)`;
    });

    document.getElementById('resetBtn').addEventListener('click', ()=>{
      document.getElementById('sellersList').innerHTML = '';
      document.getElementById('mapPlaceholder').textContent = 'Map placeholder — demo only (no external map loaded)';
    });

    // Optional: allow user to click a seller to simulate "I'm near this seller" and see rating grow
    document.getElementById('sellersList').addEventListener('click', e => {
      const card = e.target.closest('.seller');
      if(!card) return;
      const name = card.querySelector('strong').textContent;
      alert('You clicked on: ' + name + '\nIn a real app you could open directions or call the shop.');
    });

  </script></body>
</html>
